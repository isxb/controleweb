{% extends "base.html" %}

{% block back_button %}
<a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary mb-3">
    ← Voltar para o Dashboard
</a>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Cadastro de Equipamento</h2>
    <form method="POST" enctype="multipart/form-data" action="{{ url_for('cadastrar_equipamento') }}">
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label class="form-label">Data de Chegada</label>
                    <input type="datetime-local" class="form-control" name="data_chegada" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Número de Patrimônio</label>
                    <input type="text" class="form-control" name="patrimonio" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Responsável</label>
                    <select class="form-select" name="responsavel_id">
                        <option value="">Selecione...</option>
                        {% for usuario in usuarios %}
                        <option value="{{ usuario.id }}">{{ usuario.username }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">CPF do Responsável</label>
                    <input type="text" class="form-control cpf-input" name="cpf" placeholder="000.000.000-00">
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="mb-3">
                    <label class="form-label">Matrícula</label>
                    <input type="text" class="form-control" name="matricula">
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Modelo do Notebook</label>
                    <input type="text" class="form-control" name="modelo" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Acessórios</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="carregador" id="carregador">
                        <label class="form-check-label" for="carregador">Carregador</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="mochila" id="mochila">
                        <label class="form-check-label" for="mochila">Mochila</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="mouse" id="mouse">
                        <label class="form-check-label" for="mouse">Mouse</label>
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Termo de Responsabilidade (PDF)</label>
                    <input type="file" class="form-control" name="termo" accept=".pdf">
                </div>
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary">Cadastrar Equipamento</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const cpfInput = document.querySelector('.cpf-input');
    if (cpfInput) {
        cpfInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.substring(0, 11);
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        });
    }
});
</script>
{% endblock %}